<ng-container *ngIf="snapshot$ | async as snapshot">
  <ng-template #toolTemplate>
    <fa-icon *ngIf="icon"
             [fixedWidth]="true"
             [spin]="snapshot.animate === 'spin'"
             [pulse]="snapshot.animate === 'pulse'"
             [icon]="snapshot.icon"
             [matTooltip]="snapshot.toolTip"></fa-icon>
    <span *ngIf="title">{{snapshot.title}}</span>
  </ng-template>
  <ng-container *ngIf="snapshot.visible">
    <div *ngIf="mode === 'menu'"
         class="tag-menu-compact"
         (click)="mouseDown($event)"
         [class.text-success]="snapshot.color === 'success'"
         [class.text-warning]="snapshot.color === 'warning'"
         [class.text-danger]="snapshot.color === 'danger'"
         [class.text-info]="snapshot.color === 'info'"
         [class.text-muted]="muted"
         [class.highlighted]="snapshot.highlight"
         [disabled]="snapshot.disabled"
         mat-menu-item>
      <ng-container *ngTemplateOutlet="toolTemplate"></ng-container>
    </div>
    <button *ngIf="mode === 'icon'"
            type="button"
            (mousedown)="mouseDown($event)"
            (mouseup)="mouseUp($event)"
            [class.text-success]="snapshot.color === 'success'"
            [class.text-warning]="snapshot.color === 'warning'"
            [class.text-danger]="snapshot.color === 'danger'"
            [class.text-info]="snapshot.color === 'info'"
            [class.text-muted]="muted"
            [class.highlighted]="snapshot.highlight"
            [disabled]="snapshot.disabled"
            mat-icon-button>
      <ng-container *ngTemplateOutlet="toolTemplate"></ng-container>
    </button>
    <button *ngIf="mode === 'button'"
            type="button"
            (mousedown)="mouseDown($event)"
            (mouseup)="mouseUp($event)"
            [class.text-success]="snapshot.color === 'success'"
            [class.text-warning]="snapshot.color === 'warning'"
            [class.text-danger]="snapshot.color === 'danger'"
            [class.text-info]="snapshot.color === 'info'"
            [class.text-muted]="muted"
            [class.highlighted]="snapshot.highlight"
            [disabled]="snapshot.disabled"
            mat-button>
      <ng-container *ngTemplateOutlet="toolTemplate"></ng-container>
    </button>
  </ng-container>
</ng-container>
